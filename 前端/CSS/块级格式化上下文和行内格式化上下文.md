# 块级格式化上下文和行内格式化上下文

[参考1](https://juejin.im/post/59b73d5bf265da064618731d#heading-0)

[参考2](http://www.ayqy.net/doc/css2-1/visuren.html#block-formatting)

## 块级格式化上下文(Block Formatting Context 简称 BFC)

块级格式化上下文是CSS2.1规范定义的，一个关于CSS渲染定位的一个概念。

块级格式化上下文是决定`块盒`的布局和浮动互相影响范围的一个区域

### BFC创建方法

+ 根元素或其它包含它的元素
+ 浮动 (元素的`float`不为`none`)
+ 绝对定位的元素 (元素的`position`为`absolute`或`fixed`)
+ 行内块`inline-blocks`(元素的 `display: inline-block`)
+ 表格单元格(元素的`display: table-cell`，HTML表格单元格默认属性)
+ `overflow`的值不为`visible`的元素
+ 弹性盒 `flex boxes` (元素的`display: flex`或`inline-flex`)

最常见的就是`overflow:hidden`、`float:left/right`、`position:absolute`

### BFC的影响范围

> A block formatting context contains everything inside of the element creating it that is not also inside a descendant element that creates a new block formatting context.


BFC影响的范围是**包含创建该上下文元素的所有子元素**，但**不包含创建了新的BFC的子元素内部的子元素**

例子:

```html
<div id="D1" class="bfc">
    <div id="D2">
        <div id="D3"></div>
        <div id="D4"></div>
    </div>
    <div id="D5" class="bfc">
        <div id="D6"></div>
        <div id="D7"></div>
    </div>
    <div id="D8"></div>
</div>
```

如上例所示，D1创建了一个BFC，所以D1的BFC的覆盖范围是D2、D3、D4、D5、D8。即`包含创建该上下文元素的所有子元素`。

但是因为D5创建了一个新的BFC，所以D1不包含D6和D7，D6和D7的BFC上下文范围是属于D5的。即`不包含创建了新的BFC的子元素内部的子元素`

### BFC的特性

> In a block formatting context, boxes are laid out one after the other, vertically, beginning at the top of a containing block. The vertical distance between two sibling boxes is determined by the 'margin' properties. Vertical margins between adjacent block-level boxes in a block formatting context collapse.

> In a block formatting context, each box's left outer edge touches the left edge of the containing block (for right-to-left formatting, right edges touch). This is true even in the presence of floats (although a box's line boxes may shrink due to the floats), unless the box establishes a new block formatting context (in which case the box itself may become narrower due to the floats).

+ 在一个块格式化上下文中，从包含块的顶部开始， 盒在垂直方向一个接一个地放置

+ 上下两个盒之间的垂直距离由'margin'属性决定

+ 同一个块格式化上下文中，相邻的盒子之间的垂直外边距会合并 (即会出现 margin collapse)

+ 在一个块格式化上下文中, 每个盒的左外边界(left outer edge)紧挨着包含块(父级)的左外边界(从右的则挨着右外边界)

+ BFC就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面的元素，反之亦然

+ 计算BFC的高度时，考虑BFC所包含的所有元素，连浮动元素也参与计算

+ 浮动盒区域不叠加到BFC上

### 特性解析的例子
